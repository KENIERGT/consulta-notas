<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Consulta de Notas</title>
   <h1>Bachillerato Comunitario de JYA - III Cuatrimestre</h1>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #00aae4;
      padding: 20px;
      color: #333;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      width: 300px;
      margin: 10px 0;
      border: none;
      border-radius: 5px;
    }
    button {
      background-color: #005fa3;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #004080;
    }
    #resultado {
      margin-top: 20px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h2>üîç Consulta de Notas</h2>
  <input type="text" id="codigo" placeholder="Ingresa tu c√≥digo de estudiante">
  <button onclick="buscarNotas()">Consultar</button>

  <div id="resultado"></div>

  <script>
    const SHEET_ID = "1TnSKjSRX1vwBD1EjA9yRJw0sp8ezyhskQ_WXpKbqpA8";
    const SHEET_GID = "1285346484";

    async function buscarNotas() {
      const codigo = document.getElementById('codigo').value.trim();
      const resultado = document.getElementById('resultado');
      resultado.innerHTML = "Buscando...";

      const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&gid=${SHEET_GID}`;

      try {
        const res = await fetch(url);
        const text = await res.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        let encontrado = false;
        for (const row of rows) {
          const cod = row.c[1]?.v;
          if (cod && cod.trim() === codigo) {
            const nombre = row.c[0]?.v;
            const sesion = row.c[2]?.v;
            const mat = Number(row.c[3]?.v).toFixed(1);
            const lyl = Number(row.c[4]?.v).toFixed(1);
            const ingles = Number(row.c[5]?.v).toFixed(1);
            const quimica = Number(row.c[6]?.v).toFixed(1);
            const geo = Number(row.c[7]?.v).toFixed(1);
            const ddm = Number(row.c[8]?.v).toFixed(1);
            const promedio = Number(row.c[9]?.v).toFixed(1);

            resultado.innerHTML = `
              <h5>üë§ ${nombre}</h5>
              <p><strong>Sesi√≥n:</strong> ${sesion}</p>
              <p>üìò Matem√°tica: ${mat}</p>
              <p>üìö Lengua y Literatura: ${lyl}</p>
              <p>üî§ Ingl√©s: ${ingles}</p>
              <p>üß™ Qu√≠mica: ${quimica}</p>
              <p>üó∫Ô∏è Geograf√≠a: ${geo}</p>
              <p>üìê DDM: ${ddm}</p>
              <p><strong>üìä Promedio:</strong> ${promedio}</p>
            `;
            encontrado = true;
            break;
          }
        }

        if (!encontrado) {
          resultado.innerHTML = "‚ùå C√≥digo no encontrado. Verifica e intenta de nuevo.";
        }

      } catch (error) {
        resultado.innerHTML = "‚ö†Ô∏è Error al conectar con la hoja. Revisa si el documento es p√∫blico.";
        console.error(error);
      }
    }
  </script>
</body>
</html>

