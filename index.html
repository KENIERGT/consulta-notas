<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Bachillerato Comunitario de JYA</title>

  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRWrQx4Wm88UkrwZSWK2QLKWuCjsNvFm2cWrQ&s" alt="150px" width="200px">
  <img src="logo.png/logo1.png" height="100px" width="100px">

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #ffffff;
      padding:65px;
      color: #000000;
    }
    input, button {
      padding:16px;
      font-size: 15px;
      width: 150px;
      margin:10px;
      border:none;
      border-radius: 20px;
    }
    button {
      background-color: #6aff00;
      color: rgb(0, 0, 0);
      cursor: pointer;
    }
    button:hover {
      background-color: #004080;
    }
    #resultado {
      margin-top: 20px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(255, 6, 6, 0.1);
    }
  </style>
</head>
<body>
  <h1>Bachillerato Comunitario de JYA</h1> 
<style>
    body {
      font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
      box-shadow: #052443;
      color: #000000;
    }

</style>
  <h3>Instituto Rosa Montoya Flores</h3>
  <h1>üîç Consulta de Notas </h1>
  <input type="text" id="codigo" placeholder="Ingrese su c√≥digo">
  <button onclick="buscarNotas()">Consultar</button>

  <div id="resultado"></div>

  <script>
    const SHEET_ID = "1TnSKjSRX1vwBD1EjA9yRJw0sp8ezyhskQ_WXpKbqpA8";
    const SHEET_GID = "1285346484";

    async function buscarNotas() {
      const codigo = document.getElementById('codigo').value.trim();
      const resultado = document.getElementById('resultado');
      resultado.innerHTML = "Buscando...";

      const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&gid=${SHEET_GID}`;

      try {
        const res = await fetch(url);
        const text = await res.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        let encontrado = false;

        function formatoNota(valor) {
          const nota = Number(valor);
          const color = nota <= 59 ? 'red' : 'black';
          return `<span style="color: ${color};">${nota.toFixed(1)}</span>`;
        }

        for (const row of rows) {
          const cod = row.c[1]?.v;
          if (cod && cod.trim() === codigo) {
            const nombre = row.c[0]?.v;
            const sesion = row.c[2]?.v;
            const mat = row.c[3]?.v;
            const lyl = row.c[4]?.v;
            const ingles = row.c[5]?.v;
            const quimica = row.c[6]?.v;
            const geo = row.c[7]?.v;
            const ddm = row.c[8]?.v;
            const promedio = row.c[9]?.v;

            resultado.innerHTML = `
              <h2>üë§ ${nombre}</h2>
              <p><strong>Secci√≥n:</strong> ${sesion}</p>
              <p>‚ûó Matem√°tica: ${formatoNota(mat)}</p>
              <p>üìö Lengua y Literatura: ${formatoNota(lyl)}</p>
              <p>üî§ Ingl√©s: ${formatoNota(ingles)}</p>
              <p>üß™ Qu√≠mica: ${formatoNota(quimica)}</p>
              <p>üó∫Ô∏è Geograf√≠a: ${formatoNota(geo)}</p>
              <p>üë© Derecho y Dignidad de la Mujer: ${formatoNota(ddm)}</p>
              <p><strong>üìä Promedio:</strong> ${formatoNota(promedio)}</p>
            `;
            encontrado = true;
            break;
          }
        }

        if (!encontrado) {
          resultado.innerHTML = "‚ùå C√≥digo no encontrado. Verifica e intenta de nuevo.";
        }

      } catch (error) {
        resultado.innerHTML = "‚ö†Ô∏è Error al conectar con la hoja. Revisa si el documento es p√∫blico.";
        console.error(error);
      }
    }
  </script>
</body>
</html>




